<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="http://p94fw3huv.bkt.clouddn.com/static/images/favicon-48-48.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="http://p94fw3huv.bkt.clouddn.com/static/images/favicon-32-32.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="http://p94fw3huv.bkt.clouddn.com/static/images/favicon-16-16.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="divide and conquer,hard,heap,binary indexed tree,segment tree," />










<meta name="description" content="26.2%  https://leetcode.com/problems/the-skyline-problem/?tab=Description A city’s skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance.">
<meta name="keywords" content="divide and conquer,hard,heap,binary indexed tree,segment tree">
<meta property="og:type" content="article">
<meta property="og:title" content="218. The Skyline Problem">
<meta property="og:url" content="http://yucc.me/p/b0846169/index.html">
<meta property="og:site_name" content="Chenchen Yu">
<meta property="og:description" content="26.2%  https://leetcode.com/problems/the-skyline-problem/?tab=Description A city’s skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://leetcode.com/static/images/problemset/skyline1.jpg">
<meta property="og:image" content="https://leetcode.com/static/images/problemset/skyline2.jpg">
<meta property="og:updated_time" content="2018-05-22T15:08:11.964Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="218. The Skyline Problem">
<meta name="twitter:description" content="26.2%  https://leetcode.com/problems/the-skyline-problem/?tab=Description A city’s skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance.">
<meta name="twitter:image" content="https://leetcode.com/static/images/problemset/skyline1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yucc.me/p/b0846169/"/>





  <title>218. The Skyline Problem | Chenchen Yu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Chenchen Yu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yucc.me/p/b0846169/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chenchen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://p94fw3huv.bkt.clouddn.com/static/images/yucc.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chenchen Yu">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">218. The Skyline Problem</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-22T14:33:11+08:00">
                2018-05-22 14:33
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-05-22T23:08:11+08:00">
                2018-05-22 23:08
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv">本文总阅读量
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,734
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  23
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <ul>
<li>26.2%</li>
</ul>
<p><a href="https://leetcode.com/problems/the-skyline-problem/?tab=Description" target="_blank" rel="noopener">https://leetcode.com/problems/the-skyline-problem/?tab=Description</a></p>
<p>A city’s skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance. Now suppose you are given the locations and height of all the buildings as shown on a cityscape photo (Figure A), write a program to output the skyline formed by these buildings collectively (Figure B).</p>
<p><img src="https://leetcode.com/static/images/problemset/skyline1.jpg" alt="image"></p>
<p><img src="https://leetcode.com/static/images/problemset/skyline2.jpg" alt="image"></p>
<p>The geometric information of each building is represented by a triplet of integers [Li, Ri, Hi], where Li and Ri are the x coordinates of the left and right edge of the ith building, respectively, and Hi is its height. It is guaranteed that 0 ≤ Li, Ri ≤ INT_MAX, 0 &lt; Hi ≤ INT_MAX, and Ri - Li &gt; 0. You may assume all buildings are perfect rectangles grounded on an absolutely flat surface at height 0.</p>
<p>For instance, the dimensions of all buildings in Figure A are recorded as: [ [2 9 10], [3 7 15], [5 12 12], [15 20 10], [19 24 8] ] .</p>
<p>The output is a list of “key points” (red dots in Figure B) in the format of [ [x1,y1], [x2, y2], [x3, y3], … ] that uniquely defines a skyline. A key point is the left endpoint of a horizontal line segment. Note that the last key point, where the rightmost building ends, is merely used to mark the termination of the skyline, and always has zero height. Also, the ground in between any two adjacent buildings should be considered part of the skyline contour.</p>
<p>For instance, the skyline in Figure B should be represented as:[ [2 10], [3 15], [7 12], [12 0], [15 10], [20 8], [24, 0] ].</p>
<p>Notes:</p>
<ul>
<li>The number of buildings in any input list is guaranteed to be in the range [0, 10000].</li>
<li>The input list is already sorted in ascending order by the left x position Li.</li>
<li>The output list must be sorted by the x position.</li>
<li>There must be no consecutive horizontal lines of equal height in the output skyline. For instance, […[2 3], [4 5], [7 5], [11 5], [12 7]…] is not acceptable; the three lines of height 5 should be merged into one in the final output as such: […[2 3], [4 5], [12 7], …]</li>
</ul>
<a id="more"></a>
<hr>
<p>需要思考</p>
<p>方法一：</p>
<p><a href="https://discuss.leetcode.com/topic/39416/guaranteed-really-detailed-and-good-perfect-explanation-of-the-skyline-problem" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/39416/guaranteed-really-detailed-and-good-perfect-explanation-of-the-skyline-problem</a></p>
<p><a href="https://briangordon.github.io/2014/08/the-skyline-problem.html" target="_blank" rel="noopener">https://briangordon.github.io/2014/08/the-skyline-problem.html</a></p>
<hr>
<p><a href="https://discuss.leetcode.com/topic/14939/my-c-code-using-one-priority-queue-812-ms" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/14939/my-c-code-using-one-priority-queue-812-ms</a></p>
<p>My C++ code using one priority queue (812 ms)</p>
<p>The idea is to do line sweep and just process the buildings only at the start and end points. The key is to use a priority queue to save all the buildings that are still “alive”. The queue is sorted by its height and end time (the larger height first and if equal height, the one with a bigger end time first). For each iteration, we first find the current process time, which is either the next new building start time or the end time of the top entry of the live queue. If the new building start time is larger than the top one end time, then process the one in the queue first (pop them until it is empty or find the first one that ends after the new building); otherswise, if the new building starts before the top one ends, then process the new building (just put them in the queue). After processing, output it to the resulting vector if the height changes. Complexity is the worst case O(NlogN)</p>
<p>Not sure why my algorithm is so slow considering others’ Python solution can achieve 160ms, any commments?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    vector&lt;pair&lt;int, int&gt;&gt; getSkyline(vector&lt;vector&lt;int&gt;&gt;&amp; buildings) &#123;</span><br><span class="line">        vector&lt;pair&lt;int, int&gt;&gt; res;</span><br><span class="line">        int cur=0, cur_X, cur_H =-1,  len = buildings.size();</span><br><span class="line">        priority_queue&lt; pair&lt;int, int&gt;&gt; liveBlg; // first: height, second, end time</span><br><span class="line">        while(cur&lt;len || !liveBlg.empty())</span><br><span class="line">        &#123; // if either some new building is not processed or live building queue is not empty</span><br><span class="line">            cur_X = liveBlg.empty()? buildings[cur][0]:liveBlg.top().second; // next timing point to process</span><br><span class="line"></span><br><span class="line">            if(cur&gt;=len || buildings[cur][0] &gt; cur_X)</span><br><span class="line">            &#123; //first check if the current tallest building will end before the next timing point</span><br><span class="line">                  // pop up the processed buildings, i.e. those  have height no larger than cur_H and end before the top one</span><br><span class="line">                while(!liveBlg.empty() &amp;&amp; ( liveBlg.top().second &lt;= cur_X) ) liveBlg.pop();</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123; // if the next new building starts before the top one ends, process the new building in the vector</span><br><span class="line">                cur_X = buildings[cur][0];</span><br><span class="line">                while(cur&lt;len &amp;&amp; buildings[cur][0]== cur_X)  // go through all the new buildings that starts at the same point</span><br><span class="line">                &#123;  // just push them in the queue</span><br><span class="line">                    liveBlg.push(make_pair(buildings[cur][2], buildings[cur][1]));</span><br><span class="line">                    cur++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            cur_H = liveBlg.empty()?0:liveBlg.top().first; // outut the top one</span><br><span class="line">            if(res.empty() || (res.back().second != cur_H) ) res.push_back(make_pair(cur_X, cur_H));</span><br><span class="line">        &#125;</span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><a href="https://discuss.leetcode.com/topic/14939/my-c-code-using-one-priority-queue-812-ms/2" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/14939/my-c-code-using-one-priority-queue-812-ms/2</a></p>
<p>Very nice idea, keeping smaller buildings alive under larger ones even though they ended already.</p>
<p>You have a few unnecessary things, though. If I’m not mistaken, mycompare just does the default ordering, vector is the default container for priority_queue, the if(len&gt;0) doesn’t help, and you don’t need a private section. I think removing that stuff would make your solution even better than it already is.</p>
<p>About Python being faster: Yeah that’s right, Python is faster now. Deal with it :-P. More seriously, here’s the probable explanation.</p>
<hr>
<p><a href="https://discuss.leetcode.com/topic/16511/share-my-divide-and-conquer-java-solution-464-ms" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/16511/share-my-divide-and-conquer-java-solution-464-ms</a></p>
<p>Share my divide and conquer java solution, 464 ms</p>
<p>Detailed explanation: <a href="http://www.geeksforgeeks.org/divide-and-conquer-set-7-the-skyline-problem/" target="_blank" rel="noopener">http://www.geeksforgeeks.org/divide-and-conquer-set-7-the-skyline-problem/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">	public List&lt;int[]&gt; getSkyline(int[][] buildings) &#123;</span><br><span class="line">		if (buildings.length == 0)</span><br><span class="line">			return new LinkedList&lt;int[]&gt;();</span><br><span class="line">		return recurSkyline(buildings, 0, buildings.length - 1);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private LinkedList&lt;int[]&gt; recurSkyline(int[][] buildings, int p, int q) &#123;</span><br><span class="line">		if (p &lt; q) &#123;</span><br><span class="line">			int mid = p + (q - p) / 2;</span><br><span class="line">			return merge(recurSkyline(buildings, p, mid),</span><br><span class="line">					recurSkyline(buildings, mid + 1, q));</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			LinkedList&lt;int[]&gt; rs = new LinkedList&lt;int[]&gt;();</span><br><span class="line">			rs.add(new int[] &#123; buildings[p][0], buildings[p][2] &#125;);</span><br><span class="line">			rs.add(new int[] &#123; buildings[p][1], 0 &#125;);</span><br><span class="line">			return rs;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private LinkedList&lt;int[]&gt; merge(LinkedList&lt;int[]&gt; l1, LinkedList&lt;int[]&gt; l2) &#123;</span><br><span class="line">		LinkedList&lt;int[]&gt; rs = new LinkedList&lt;int[]&gt;();</span><br><span class="line">		int h1 = 0, h2 = 0;</span><br><span class="line">		while (l1.size() &gt; 0 &amp;&amp; l2.size() &gt; 0) &#123;</span><br><span class="line">			int x = 0, h = 0;</span><br><span class="line">			if (l1.getFirst()[0] &lt; l2.getFirst()[0]) &#123;</span><br><span class="line">				x = l1.getFirst()[0];</span><br><span class="line">				h1 = l1.getFirst()[1];</span><br><span class="line">				h = Math.max(h1, h2);</span><br><span class="line">				l1.removeFirst();</span><br><span class="line">			&#125; else if (l1.getFirst()[0] &gt; l2.getFirst()[0]) &#123;</span><br><span class="line">				x = l2.getFirst()[0];</span><br><span class="line">				h2 = l2.getFirst()[1];</span><br><span class="line">				h = Math.max(h1, h2);</span><br><span class="line">				l2.removeFirst();</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				x = l1.getFirst()[0];</span><br><span class="line">				h1 = l1.getFirst()[1];</span><br><span class="line">				h2 = l2.getFirst()[1];</span><br><span class="line">				h = Math.max(h1, h2);</span><br><span class="line">				l1.removeFirst();</span><br><span class="line">				l2.removeFirst();</span><br><span class="line">			&#125;</span><br><span class="line">			if (rs.size() == 0 || h != rs.getLast()[1]) &#123;</span><br><span class="line">				rs.add(new int[] &#123; x, h &#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		rs.addAll(l1);</span><br><span class="line">		rs.addAll(l2);</span><br><span class="line">		return rs;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/25794/17-line-o-n-log-n-time-o-n-space-c-accepted-easy-solution-w-explanations" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/25794/17-line-o-n-log-n-time-o-n-space-c-accepted-easy-solution-w-explanations</a></p>
<p>17-Line O(n log n)-time O(n)-space C++ Accepted Easy Solution w/ Explanations</p>
<p>General idea:</p>
<p>Step 1:</p>
<p>Use a multimap to sort all boundary points. For a start point of an interval, let the height be positive; otherwise, let the height be negative. Time complexity: O(n log n)</p>
<p>Step 2:</p>
<p>Use a multiset (rather than a heap/priority_queue) to maintain the current set of heights to be considered. If a new start point is met, insert the height into the set, otherwise, delete the height. The current max height is the back() element of the multiset. For each point, the time complexity is O(log n). The overall time complexity is O(n log n).</p>
<p>Step 3:</p>
<p>Delete the points with equal heights. Time: O(n)</p>
<p>Time Complexity: O(n log n)</p>
<p>Space Complexity: O(n)</p>
<p>C++</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">	vector&lt;pair&lt;int, int&gt;&gt; getSkyline(vector&lt;vector&lt;int&gt;&gt;&amp; buildings) &#123;</span><br><span class="line"></span><br><span class="line">        // Step 1:</span><br><span class="line">		multimap&lt;int, int&gt; coords;</span><br><span class="line">		for (const vector&lt;int&gt; &amp; building : buildings) &#123;</span><br><span class="line">			coords.emplace(building[0], building[2]);</span><br><span class="line">			coords.emplace(building[1], -building[2]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        // Step 2:</span><br><span class="line">		multiset&lt;int&gt; heights = &#123; 0 &#125;;</span><br><span class="line">		map&lt;int, int&gt; corners;</span><br><span class="line">		for (const pair&lt;int, int&gt; &amp; p : coords) &#123;</span><br><span class="line">			if (p.second &gt; 0) &#123;</span><br><span class="line">				heights.insert(p.second);</span><br><span class="line">			&#125;</span><br><span class="line">			else &#123;</span><br><span class="line">				heights.erase(heights.find(-p.second));</span><br><span class="line">			&#125;</span><br><span class="line">			int cur_y = *heights.rbegin();</span><br><span class="line">			corners[p.first] = cur_y;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        // Step 3:</span><br><span class="line">		function&lt;bool(pair&lt;int, int&gt; l, pair&lt;int, int&gt; r)&gt; eq2nd = [](pair&lt;int, int&gt; l, pair&lt;int, int&gt; r)&#123; return l.second == r.second;  &#125;;</span><br><span class="line">		vector&lt;pair&lt;int, int&gt;&gt; results;</span><br><span class="line">		unique_copy(corners.begin(), corners.end(), back_insert_iterator&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt;(results), eq2nd);</span><br><span class="line">		return results;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>In fact, the last two steps can be merged together:</p>
<p>Yet another solution (C++):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">	vector&lt;pair&lt;int, int&gt;&gt; getSkyline(vector&lt;vector&lt;int&gt;&gt;&amp; buildings) &#123;</span><br><span class="line">		multimap&lt;int, int&gt; coords;</span><br><span class="line">		for (const vector&lt;int&gt; &amp; building : buildings) &#123;</span><br><span class="line">			coords.emplace(building[0], building[2]);</span><br><span class="line">			coords.emplace(building[1], -building[2]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		multiset&lt;int&gt; heights = &#123; 0 &#125;;</span><br><span class="line">		vector&lt;pair&lt;int, int&gt;&gt; corners;</span><br><span class="line">		int x = -1;</span><br><span class="line">		int y = 0;</span><br><span class="line">		for (const pair&lt;int, int&gt; &amp; p : coords) &#123;</span><br><span class="line">			if ((x &gt;= 0) &amp;&amp; (p.first != x) &amp;&amp; (corners.empty() || (corners.rbegin()-&gt;second != y))) &#123;</span><br><span class="line">				corners.emplace_back(x, y);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			if (p.second &gt;= 0) &#123;</span><br><span class="line">				heights.insert(p.second);</span><br><span class="line">			&#125;</span><br><span class="line">			else &#123;</span><br><span class="line">				heights.erase(heights.find(-p.second));</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			x = p.first;</span><br><span class="line">			y = *heights.rbegin();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		if (!corners.empty()) &#123;</span><br><span class="line">			corners.emplace_back(x, 0);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		return corners;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/14987/108-ms-17-lines-body-explained" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/14987/108-ms-17-lines-body-explained</a></p>
<p>108 ms, 17 lines body, explained</p>
<p>This is a Python version of my modification of dong.wang.1694’s brilliant C++ solution. It sweeps from left to right. But it doesn’t only keep heights of “alive buildings” in the priority queue and it doesn’t remove them as soon as their building is left behind. Instead, (height, right) pairs are kept in the priority queue and they stay in there as long as there’s a larger height in there, not just until their building is left behind.</p>
<p>In each loop, we first check what has the smaller x-coordinate: adding the next building from the input, or removing the next building from the queue. In case of a tie, adding buildings wins, as that guarantees correctness (think about it :-). We then either add all input buildings starting at that x-coordinate or we remove all queued buildings ending at that x-coordinate or earlier (remember we keep buildings in the queue as long as they’re “under the roof” of a larger actually alive building). And then, if the current maximum height in the queue differs from the last in the skyline, we add it to the skyline.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from heapq import *</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    def getSkyline(self, LRH):</span><br><span class="line">        skyline = []</span><br><span class="line">        i, n = 0, len(LRH)</span><br><span class="line">        liveHR = []</span><br><span class="line">        while i &lt; n or liveHR:</span><br><span class="line">            if not liveHR or i &lt; n and LRH[i][0] &lt;= -liveHR[0][1]:</span><br><span class="line">                x = LRH[i][0]</span><br><span class="line">                while i &lt; n and LRH[i][0] == x:</span><br><span class="line">                    heappush(liveHR, (-LRH[i][2], -LRH[i][1]))</span><br><span class="line">                    i += 1</span><br><span class="line">            else:</span><br><span class="line">                x = -liveHR[0][1]</span><br><span class="line">                while liveHR and -liveHR[0][1] &lt;= x:</span><br><span class="line">                    heappop(liveHR)</span><br><span class="line">            height = len(liveHR) and -liveHR[0][0]</span><br><span class="line">            if not skyline or height != skyline[-1][1]:</span><br><span class="line">                skyline += [x, height],</span><br><span class="line">        return skyline</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/35817/recommend-for-beginners-clean-c-implementation-with-detailed-explanation" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/35817/recommend-for-beginners-clean-c-implementation-with-detailed-explanation</a></p>
<p>[recommend for beginners]clean C++ implementation with detailed explanation</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    vector&lt;pair&lt;int, int&gt;&gt; getSkyline(vector&lt;vector&lt;int&gt;&gt;&amp; buildings) &#123;</span><br><span class="line">        vector&lt;pair&lt;int, int&gt;&gt; edges;</span><br><span class="line">        int left, right, height;</span><br><span class="line">        for(int i=0; i&lt;buildings.size(); i++)&#123;</span><br><span class="line">            left=buildings[i][0];</span><br><span class="line">            right=buildings[i][1];</span><br><span class="line">            height=buildings[i][2];</span><br><span class="line">            /*** make sure : for the same left point we use the bigger height ***/</span><br><span class="line">            edges.push_back(make_pair(left, -height));</span><br><span class="line">            edges.push_back(make_pair(right, height));</span><br><span class="line">        &#125;</span><br><span class="line">        sort(edges.begin(), edges.end());</span><br><span class="line">        vector&lt;pair&lt;int, int&gt;&gt; result;</span><br><span class="line">        /*** use the multiset to store the max height util current pos ***/</span><br><span class="line">        multiset&lt;int&gt; m;</span><br><span class="line">        /*** left most height ***/</span><br><span class="line">        m.insert(0);</span><br><span class="line">        int pre=0, cur=0;</span><br><span class="line">        for(int i=0; i&lt;edges.size(); i++)&#123;</span><br><span class="line">            pair&lt;int, int&gt; e=edges[i];</span><br><span class="line">            if(e.second &lt; 0)  m.insert(-e.second);</span><br><span class="line">            else m.erase(m.find(e.second));</span><br><span class="line">            cur=*(m.rbegin());</span><br><span class="line">            if(cur!=pre)&#123;</span><br><span class="line">                result.push_back(make_pair(e.first, cur));</span><br><span class="line">                pre=cur;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/26420/14-line-python-code-straightforward-easy-to-understand" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/26420/14-line-python-code-straightforward-easy-to-understand</a></p>
<p>14 line python code, straightforward &amp; easy to understand</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">class Solution(object):</span><br><span class="line">def getSkyline(self, buildings):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    :type buildings: List[List[int]]</span><br><span class="line">    :rtype: List[List[int]]</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    def addsky(pos, hei):</span><br><span class="line">        if sky[-1][1] != hei:</span><br><span class="line">            sky.append([pos, hei])</span><br><span class="line"></span><br><span class="line">    sky = [[-1,0]]</span><br><span class="line">    </span><br><span class="line">    # possible corner positions</span><br><span class="line">    position = set([b[0] for b in buildings] + [b[1] for b in buildings])</span><br><span class="line">    </span><br><span class="line">    # live buildings</span><br><span class="line">    live = []</span><br><span class="line">    </span><br><span class="line">    i = 0</span><br><span class="line">        </span><br><span class="line">    for t in sorted(position):</span><br><span class="line">        </span><br><span class="line">        # add the new buildings whose left side is lefter than position t</span><br><span class="line">        while i &lt; len(buildings) and buildings[i][0] &lt;= t:</span><br><span class="line">            heappush(live, (-buildings[i][2], buildings[i][1]))</span><br><span class="line">            i += 1</span><br><span class="line">            </span><br><span class="line">        # remove the past buildings whose right side is lefter than position t</span><br><span class="line">        while live and live[0][1] &lt;= t:</span><br><span class="line">            heappop(live)</span><br><span class="line">        </span><br><span class="line">        # pick the highest existing building at this moment</span><br><span class="line">        h = -live[0][0] if live else 0</span><br><span class="line">        addsky(t, h)</span><br><span class="line"></span><br><span class="line">    return sky[1:]</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/34119/10-line-python-solution-104-ms" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/34119/10-line-python-solution-104-ms</a></p>
<p>10-line Python solution, 104 ms</p>
<p>Use an infinite vertical line x to scan from left to right. If max height changes, record [x, height] in res. Online judge is using Python 2.7.9 and there’s no max heap’s push and pop method, so we can use a min heap hp storing -H as “max heap”. Thanks to <a href="https://leetcode.com/discuss/37736/108-ms-17-lines-body-explained" target="_blank" rel="noopener">this discussion</a>, set comprehension is faster and shorter than list(set((R, 0, None) for L, R, H in buildings)).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def getSkyline(self, buildings):</span><br><span class="line">    events = sorted([(L, -H, R) for L, R, H in buildings] + list(&#123;(R, 0, None) for _, R, _ in buildings&#125;))</span><br><span class="line">    res, hp = [[0, 0]], [(0, float(&quot;inf&quot;))]</span><br><span class="line">    for x, negH, R in events:</span><br><span class="line">        while x &gt;= hp[0][1]: </span><br><span class="line">            heapq.heappop(hp)</span><br><span class="line">        if negH: </span><br><span class="line">            heapq.heappush(hp, (negH, R))</span><br><span class="line">        if res[-1][1] + hp[0][0]: </span><br><span class="line">            res += [x, -hp[0][0]],</span><br><span class="line">    return res[1:]</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/22482/short-java-solution" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/22482/short-java-solution</a></p>
<p>Short Java solution</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;int[]&gt; getSkyline(int[][] buildings) &#123;</span><br><span class="line">    List&lt;int[]&gt; result = new ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;int[]&gt; height = new ArrayList&lt;&gt;();</span><br><span class="line">    for(int[] b:buildings) &#123;</span><br><span class="line">        height.add(new int[]&#123;b[0], -b[2]&#125;);</span><br><span class="line">        height.add(new int[]&#123;b[1], b[2]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    Collections.sort(height, (a, b) -&gt; &#123;</span><br><span class="line">            if(a[0] != b[0]) </span><br><span class="line">                return a[0] - b[0];</span><br><span class="line">            return a[1] - b[1];</span><br><span class="line">    &#125;);</span><br><span class="line">    Queue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;((a, b) -&gt; (b - a));</span><br><span class="line">    pq.offer(0);</span><br><span class="line">    int prev = 0;</span><br><span class="line">    for(int[] h:height) &#123;</span><br><span class="line">        if(h[1] &lt; 0) &#123;</span><br><span class="line">            pq.offer(-h[1]);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            pq.remove(h[1]);</span><br><span class="line">        &#125;</span><br><span class="line">        int cur = pq.peek();</span><br><span class="line">        if(prev != cur) &#123;</span><br><span class="line">            result.add(new int[]&#123;h[0], cur&#125;);</span><br><span class="line">            prev = cur;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><a href="https://discuss.leetcode.com/topic/28482/once-for-all-explanation-with-clean-java-code-o-n-2-time-o-n-space" target="_blank" rel="noopener">https://discuss.leetcode.com/topic/28482/once-for-all-explanation-with-clean-java-code-o-n-2-time-o-n-space</a></p>
<p>Once for all, explanation with clean Java code(O(n^2)time, O(n) space)</p>
<p>Though I came up with a solution using PriorityQueue and BST, this problems still confuses me. To make it more clear, I went through it several times and investigated several good solutions on this forum.</p>
<p>Here is my explanation which tries to make understanding this easier and may help you write a bug-free solution quickly.</p>
<p>When visiting all start points and end points in order:</p>
<p>Observations:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">If a position is shadowed by other buildings</span><br><span class="line"></span><br><span class="line"> 1. height of that building is larger than the building to which current</span><br><span class="line">     position belong;</span><br><span class="line"> 2. the start point of that building must be smaller(or equal to) than this</span><br><span class="line">     position;</span><br><span class="line"> 3. the end point of that building must be larger(or equal to) than this</span><br><span class="line">     position;</span><br></pre></td></tr></table></figure>
<p>Tus we have:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. when you reach a start point, the height of current building immediately</span><br><span class="line">    takes effect which means it could possibly affect the contour or shadow</span><br><span class="line">    others when mixed with other following buildings;</span><br><span class="line">2. when you reach a end point, the height of current building will stop its</span><br><span class="line">    influences;</span><br><span class="line">3. our target exists at the position where height change happens and there</span><br><span class="line">    is nothing above it shadowing it;</span><br></pre></td></tr></table></figure>
<p>Obviously, to implement the idea that ‘current height takes effect’ and ‘find out whether current height is shadowed by other buildings’, we need a mechanism to store current taking effect heights, meanwhile, figure out which one is the maximum, delete it if needed efficiently, which hints us to use a priority queue or BST.</p>
<p>Thus, our algorithm could be summarised in following pseudo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for position in sorted(all start points and all end points)</span><br><span class="line">       if this position is a start point</span><br><span class="line">              add its height</span><br><span class="line">       else if this position is a end point</span><br><span class="line">              delete its height</span><br><span class="line">       compare current max height with previous max height, if different, add</span><br><span class="line">       current position together with this new max height to our result, at the</span><br><span class="line">       same time, update previous max height to current max height;</span><br></pre></td></tr></table></figure>
<p>To implement this algorithm, here are some concrete examples:</p>
<p>In my implementation, I use a PriorityQueue to store end point values when visiting a start point, and store the [height, end point value] into a TreeMap. Thus:</p>
<pre><code>1. when moving to next start point value, I can compare the next start point value with elements in PriorityQueue, thus achieving visiting all start points and end points in order(exploits the fact that start points are already sorted);
2. Meantime, I can get current max height from TreeMap in O(logn);
3. However, to delete a height when visiting a end point, I have to use &apos;map.values.remove()&apos; which is a method defined in Collection interface and tends to be slower(O(n) is this case, plz correct me if I&apos;m wrong);
</code></pre><p>My code can be found at <a href="https://leetcode.com/discuss/62617/short-and-clean-java-solution-heap-and-treemap" target="_blank" rel="noopener">https://leetcode.com/discuss/62617/short-and-clean-java-solution-heap-and-treemap</a></p>
<p>Following is wujin’s implementation(plz refer to <a href="https://leetcode.com/discuss/54201/short-java-solution)" target="_blank" rel="noopener">https://leetcode.com/discuss/54201/short-java-solution)</a>. This one is quite straightforward, clean and clever.<br>Firstly, please notice what we need to achieve:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. visit all start points and all end points in order;</span><br><span class="line">2. when visiting a point, we need to know whether it is a start point or a</span><br><span class="line">  end point, based on which we can add a height or delete a height from</span><br><span class="line">  our data structure;</span><br></pre></td></tr></table></figure>
<p>To achieve this, his implementation:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. use a int[][] to collect all [start point, - height] and [end point, height]</span><br><span class="line">  for every building;</span><br><span class="line">2. sort it, firstly based on the first value, then use the second to break</span><br><span class="line">  ties;</span><br></pre></td></tr></table></figure>
<p>Thus,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. we can visit all points in order;</span><br><span class="line">2. when points have the same value, higher height will shadow the lower one;</span><br><span class="line">3. we know whether current point is a start point or a end point based on the</span><br><span class="line">  sign of its height;</span><br></pre></td></tr></table></figure>
<p>His code is as follows(clear and concise) as reference with my comment(again, <a href="https://leetcode.com/discuss/54201/short-java-solution)" target="_blank" rel="noopener">https://leetcode.com/discuss/54201/short-java-solution)</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;int[]&gt; getSkyline(int[][] buildings) &#123;</span><br><span class="line">    List&lt;int[]&gt; result = new ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;int[]&gt; height = new ArrayList&lt;&gt;();</span><br><span class="line">    for(int[] b:buildings) &#123;</span><br><span class="line">        // start point has negative height value</span><br><span class="line">        height.add(new int[]&#123;b[0], -b[2]&#125;);</span><br><span class="line">        // end point has normal height value</span><br><span class="line">        height.add(new int[]&#123;b[1], b[2]&#125;); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // sort $height, based on the first value, if necessary, use the second to</span><br><span class="line">    // break ties</span><br><span class="line">    Collections.sort(height, (a, b) -&gt; &#123;</span><br><span class="line">            if(a[0] != b[0]) </span><br><span class="line">                return a[0] - b[0];</span><br><span class="line">            return a[1] - b[1];</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // Use a maxHeap to store possible heights</span><br><span class="line">    Queue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;((a, b) -&gt; (b - a));</span><br><span class="line"></span><br><span class="line">    // Provide a initial value to make it more consistent</span><br><span class="line">    pq.offer(0);</span><br><span class="line"></span><br><span class="line">    // Before starting, the previous max height is 0;</span><br><span class="line">    int prev = 0;</span><br><span class="line"></span><br><span class="line">    // visit all points in order</span><br><span class="line">    for(int[] h:height) &#123;</span><br><span class="line">        if(h[1] &lt; 0) &#123; // a start point, add height</span><br><span class="line">            pq.offer(-h[1]);</span><br><span class="line">        &#125; else &#123;  // a end point, remove height</span><br><span class="line">            pq.remove(h[1]);</span><br><span class="line">        &#125;</span><br><span class="line">        int cur = pq.peek(); // current max height;</span><br><span class="line">  </span><br><span class="line">        // compare current max height with previous max height, update result and </span><br><span class="line">        // previous max height if necessary</span><br><span class="line">        if(prev != cur) &#123;</span><br><span class="line">            result.add(new int[]&#123;h[0], cur&#125;);</span><br><span class="line">            prev = cur;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Hopefully now, you can write a good solution in a blink with good understanding…</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>谢谢你！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>赞赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="http://p94fw3huv.bkt.clouddn.com/static/images/wechatpay.jpg" alt="Chenchen Yu 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="http://p94fw3huv.bkt.clouddn.com/static/images/alipay.jpg" alt="Chenchen Yu 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Marco Yu
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yucc.me/p/b0846169/" title="218. The Skyline Problem">http://yucc.me/p/b0846169/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/divide-and-conquer/" rel="tag"># divide and conquer</a>
          
            <a href="/tags/hard/" rel="tag"># hard</a>
          
            <a href="/tags/heap/" rel="tag"># heap</a>
          
            <a href="/tags/binary-indexed-tree/" rel="tag"># binary indexed tree</a>
          
            <a href="/tags/segment-tree/" rel="tag"># segment tree</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/p/4dd031de/" rel="next" title="217. Contains Duplicate">
                <i class="fa fa-chevron-left"></i> 217. Contains Duplicate
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/p/4c1e3175/" rel="prev" title="219. Contains Duplicate II">
                219. Contains Duplicate II <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://p94fw3huv.bkt.clouddn.com/static/images/yucc.jpg"
                alt="Chenchen Yu" />
            
              <p class="site-author-name" itemprop="name">Chenchen Yu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">381</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">65</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yucc2018" target="_blank" title="github">
                      
                        <i class="fa fa-fw fa-github"></i>github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://zhuanlan.zhihu.com/yuchenchen" target="_blank" title="zhihu">
                      
                        <i class="fa fa-fw fa-globe"></i>zhihu</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/zxjhdn" target="_blank" title="weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.linkedin.com/in/chenchen-yu-510401107/" target="_blank" title="Linkedin">
                      
                        <i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/yucc2018" target="_blank" title="twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/yucc2018" target="_blank" title="facebook">
                      
                        <i class="fa fa-fw fa-facebook"></i>facebook</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:6506666@gmail.com" target="_blank" title="email">
                      
                        <i class="fa fa-fw fa-envelope"></i>email</a>
                  </span>
                
            </div>
          

          
          

          
          

          
        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chenchen Yu</span>

  
</div>

<div>
<span id="showDays"></span>
</div>





<script>
  var seconds = 1000;
  var minutes = seconds * 60;
  var hours = minutes * 60;
  var days = hours * 24;
  var years = days * 365;
  var birthDay = Date.UTC(2018,04,23,12,00,00); // 这里设置建站时间
  setInterval(function() {
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    var now = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = now - birthDay;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      document.getElementById('showDays').innerHTML="本站已运行 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 ";
  }, 1000);
</script>
        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      本站总访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
        <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitment({
            id: window.location.pathname, 
            owner: 'yucc2018',
            repo: 'yucc2018.github.io',
            
            oauth: {
            
            
                client_secret: '704923b823cfe85343062ae2444019597f96be86',
            
                client_id: '174a67d1482f56c9aabb'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
